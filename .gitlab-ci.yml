image: "ruby:2.7"

before_script:
  - apt-get update -qq && apt-get install -y -qq sqlite3 libsqlite3-dev nodejs
  - ruby -v
  - which ruby
  - gem install bundler --no-document
  - bundle install --jobs $(nproc)  "${FLAGS[@]}"
  - bundle install --gemfile=gemfiles/rails_5.0.gemfile
  - bundle install --gemfile=gemfiles/rails_5.1.gemfile
  - bundle install --gemfile=gemfiles/rails_5.2.gemfile
  - bundle install --gemfile=gemfiles/rails_6.0.gemfile
                             
test:                        
  script:                    
    - bundle exec rake test  
                             
rubocop:                     
  script:                    
    - bundle exec rubocop    
                             
appraisal:                   
  script:                    
    - bundle exec appraisal rake
