image: "ruby:3.2"

before_script:
  - apt-get update -qq && apt-get install -y -qq sqlite3 libsqlite3-dev nodejs
  - ruby -v
  - which ruby
  - gem install bundler --no-document
  - bundle install --jobs $(nproc)  "${FLAGS[@]}"
  - bundle install --gemfile=gemfiles/rails_6.0.gemfile
  - bundle install --gemfile=gemfiles/rails_6.1.gemfile
  - bundle install --gemfile=gemfiles/rails_7.0.gemfile
  - bundle install --gemfile=gemfiles/rails_7.1.gemfile

rake:
  script:
    - bundle exec rake

appraisal:
  script:
    - bundle exec appraisal rake
